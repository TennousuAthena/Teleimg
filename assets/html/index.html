<!doctype html>
<html lang="en" class="h-100">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="TennousuAthena">
    <title>Teleimg - Image Upload</title>

    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/dropzone.min.css" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">
    <link rel="manifest" href="assets/site.webmanifest">
    <meta name="theme-color" content="#13227a">


    <style>
        main > .container {
            padding: 60px 15px 0;
        }
    </style>
</head>
<body class="d-flex flex-column h-100">
<header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <div class="container nav-main">
            <a class="navbar-brand" href="/">Teleimg</a>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/TennousuAthena/Teleimg">About</a>
                    </li>
                </ul>
            </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->
    </nav>
</header>

<!-- Begin page content -->
<main class="flex-shrink-0">
    <div class="container">
        <h1 class="mt-5">Image Upload</h1>
        <p class="lead">Please select your images and we will get them uploaded.</p>
        <form class="dropzone rounded" id="myDropzone">
            <div class="am-text-success dz-message">
                Drop files here to upload<br>Or click here to open the explorer to select the files
            </div>

            <div class="fallback">
                <input name="file" type="file" multiple />
            </div>
        </form>
        <div class="dropzone-previews"></div>

        <br />

        <div class="container" id="imgShow" style="display:none;margin-top: 10px;">

        </div>
    </div>
</main>

<footer class="footer mt-auto py-3 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <p class="text-muted">
                        Please <strong>DO NOT</strong> upload pictures that violate the laws of your region. <span title="Not Suitable For Work">NSFW</span> images are not welcomed. <span>Copyright â’¸ All rights reserved.

                        <a href="https://t.me/joinchat/RebO6OW_DoDajiVJ" title="Telegram Group">Telegram</a>
                    </span></p>
                </div>
                <div class="col-lg-9">
                    <div class="advert_title text-muted">
                        Storage by
                        <a href="https://telegra.ph/" target="_blank" title="Made possible by Telegraph">Telegraph</a>
                        & Accelerated by
                        <img onclick="window.open('https://curl.qcloud.com/ysARP1Dp')" src="https://cdn.jsdelivr.net/gh/TennousuAthena/tennousuathena.github.io/source/assets/img/qcloud.svg" alt="Tencent Cloud">
                    </div>
                </div>
            </div>
        </div>
</footer>

<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/dropzone.min.js"></script>
<script type="text/javascript">
    Dropzone.autoDiscover = false;
    let myDropzone = new Dropzone("#myDropzone", {
        url: "/upload",
        uploadMultiple: false,
        method: 'post',
        filesizeBase: 1024,
        sending: function(file, xhr, formData) {
            formData.append("filesize", file.size);
        },
        success: function (file, response, e) {
            console.log(response)
            // file.previewTemplate.appendChild(document.createTextNode(response.src));
            // window.open(window.location.origin + response.src)
            if (!response.success) {
                $(file.previewTemplate).children('.dz-error-mark').css('opacity', '1')
            }else{
                $("#imgShow").append('<div class="row border rounded" style="margin-top: 10px;">\n' +
                    '<div class="col-lg-5"><img src="'+response.src+'" class="w-75" alt="Image"></div>\n' +
                    '<div class="col-lg-7"><div class="input-group mb-3">\n' +
                    '  <div class="input-group-prepend">\n' +
                    '    <span class="input-group-text" id="inputGroup-sizing-default">Image URL</span>\n' +
                    '  </div>\n' +
                    '  <input type="text" class="form-control" onclick="this.select();" value="'+ window.location.origin + response.src + '">\n' +
                    '<div class="input-group mb-3"><div class="input-group-prepend">\n' +
                    '    <span class="input-group-text" id="inputGroup-sizing-default">Markdown</span>\n' +
                    '  </div>\n' +
                    '  <input type="text" class="form-control" onclick="this.select();" value="![Image]('+ window.location.origin + response.src + ')">\n' +
                    '</div></div></div>\n' +
                    '</div>').fadeIn();
            }
        }
    });
</script>
</body>
</html>
